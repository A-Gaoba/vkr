import{j as e,h as L,r,Q as B,M as E,b as d,A as c,B as C}from"./index-DUfxJ4v1.js";import{f as F}from"./format-cwXK75ha.js";const T=({student:a})=>{const t=i=>i.charAt(0).toUpperCase()+i.slice(1),s=(i,m)=>e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("label",{className:"font-semibold text-gray-700",children:[i,":"]}),e.jsx("span",{className:"p-2 text-gray-800 flex-grow",children:m})]}),{firstName:u,middleName:o,lastName:p,dateOfBirth:w,email:y,phoneNumber:$,address:N}=a,S=F(new Date(w),"MMMM dd, yyyy"),b=`${t(u)} ${o?t(o):""} ${t(p)}`.trim();return e.jsxs("section",{className:"bg-white rounded-lg shadow-lg p-6 mb-4",children:[e.jsx("div",{className:"flex justify-between items-center p-4",children:e.jsx("div",{className:"w-32 h-32 overflow-hidden rounded-full border-4 border-indigo-300 shadow-lg",children:e.jsx("img",{src:"../../../../../../../public/person-svgrepo-com.svg",alt:b,className:"w-full h-full object-cover"})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"col-span-2 space-y-4",children:[s("Full Name",b),s("Date of Birth",S),s("Email",y)]}),e.jsxs("div",{className:"space-y-4",children:[s("Phone Number",$),s("Address",N)]})]})]})},v=({label:a,value:t})=>e.jsxs("p",{className:"mb-2 md:text-base text-sm",children:[e.jsxs("span",{className:"font-bold",children:[a,":"]})," ",t]}),k=({studentId:a,classLevel:t,grades:s,nextClass:u,onMoveToNextLevel:o})=>e.jsxs("section",{className:"mb-8 bg-white p-6 rounded-md shadow-md",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"md:text-xl font-semibold mb-2",children:"Academic Information"}),e.jsx("button",{onClick:o,className:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",disabled:!u,children:"Move to Next Level"})]}),e.jsx(v,{label:"Student ID",value:a}),e.jsx(v,{label:"Class",value:`Class ${t||"undefined"}`})]}),O=({subjects:a})=>e.jsxs("div",{className:"mt-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-blue-700",children:"Subjects"}),a.length?e.jsxs("table",{className:"min-w-full table-auto text-sm text-left text-gray-500",children:[e.jsx("thead",{className:"text-xs text-gray-700 uppercase bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Subject Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Description"}),e.jsx("th",{scope:"col",className:"px-6 py-3",children:"Teacher"})]})}),e.jsx("tbody",{children:a.map(t=>e.jsxs("tr",{className:"bg-white border-b",children:[e.jsx("td",{className:"px-6 py-4",children:t.name}),e.jsx("td",{className:"px-6 py-4",children:t.description}),e.jsx("td",{className:"px-6 py-4 text-blue-500",children:t.teacher?e.jsxs("span",{children:[t.teacher.firstName," ",t.teacher.lastName]}):e.jsx("p",{className:"text-slate-300",children:"No teacher assigned"})})]},t.id))})]}):e.jsx("p",{className:"text-gray-500",children:"No subjects listed for this class."})]}),U=({attendanceInfo:a})=>e.jsxs("section",{className:"mb-8 bg-white p-6 rounded-md shadow-md",children:[e.jsx("h2",{className:"md:text-xl font-semibold mb-2",children:"Attendance Information"}),e.jsx(v,{label:"Total Classes Attended",value:a.totalClassesAttended||"N/A"}),e.jsx(v,{label:"Attendance Percentage",value:`${a.attendancePercentage||"N/A"}%`})]}),z=()=>{const{id:a}=L(),t=parseInt(a||"0",10),[s,u]=r.useState(null),[o,p]=r.useState(null),[w,y]=r.useState([]),[$,N]=r.useState([]),[S,b]=r.useState(!0),[i,m]=r.useState(!1),[l,I]=r.useState(null);r.useEffect(()=>{(async()=>{try{const h=(await d.get(`${c}/students/${t}`)).data;if(u(h),h.classId){const[g,n]=await Promise.all([d.get(`${c}/classes/${h.classId}`),d.get(`${c}/classes`)]);p(g.data),y(n.data);const A=await d.get(`${c}/classes/${h.classId}/subjects`),D=await Promise.all(A.data.map(async x=>{if(x.teacherId){const P=await d.get(`${c}/teachers/${x.teacherId}`);x.teacher=P.data}return x}));N(D);const M=n.data.find(x=>x.level===g.data.level+1);I(M||null)}}catch(j){console.error("Failed to fetch data:",j)}finally{b(!1)}})()},[t]);const R=async()=>{if(s&&l)try{await d.put(`${c}/students/${s.id}`,{classId:l.id});const f=await d.get(`${c}/classes/${l.id}`),j=await d.get(`${c}/classes/${l.id}/subjects`),h=await Promise.all(j.data.map(async n=>{if(n.teacherId){const A=await d.get(`${c}/teachers/${n.teacherId}`);n.teacher=A.data}return n}));p(f.data),N(h);const g=w.find(n=>n.level===f.data.level+1);I(g||null),C.success(`${s.firstName} ${s.lastName} has been moved to Class ${l.level}.`)}catch(f){console.error("Failed to update student:",f),C.error("Failed to move student to the next level.")}m(!1)};return S?e.jsx("div",{children:"Loading..."}):s?e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx(B,{}),e.jsxs("h1",{className:"text-2xl font-bold mb-4",children:[s.firstName," ",s.lastName,"'s Profile"]}),e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(T,{student:s}),e.jsx(k,{studentId:s.id,classLevel:o==null?void 0:o.level,grades:s.grades,nextClass:l,onMoveToNextLevel:()=>m(!0)}),e.jsx(O,{subjects:$}),e.jsx(U,{attendanceInfo:s.attendanceInfo||{totalClassesAttended:void 0,attendancePercentage:void 0}})]})}),e.jsxs(E,{isOpen:i,onRequestClose:()=>m(!1),contentLabel:"Confirm Move",className:"bg-white p-6 rounded-md shadow-md",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Confirm Move"}),e.jsxs("p",{children:["Are you sure you want to move ",s.firstName," ",s.lastName," to the next class level (Class ",l==null?void 0:l.level,")?"]}),e.jsxs("div",{className:"flex justify-end mt-4",children:[e.jsx("button",{onClick:R,className:"bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded mr-2",disabled:!l,children:"Yes"}),e.jsx("button",{onClick:()=>m(!1),className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded",children:"No"})]})]})]}):e.jsx("div",{className:"text-red-500",children:"Student not found"})};export{z as default};
